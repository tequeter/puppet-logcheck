# Reference
<!-- DO NOT EDIT: This document was generated by Puppet Strings -->

## Table of Contents

**Classes**

* [`logcheck`](#logcheck): Main API
* [`logcheck::config`](#logcheckconfig): Configure global logcheck behavior
* [`logcheck::install`](#logcheckinstall): Manage packages

**Defined types**

* [`logcheck::ruleset`](#logcheckruleset): Configure which log entries should be reported.

**Functions**

_Public Functions_


_Private Functions_

* `logcheck::augeas_change`: Transforms a logcheck.conf key-value pair into an Augeas instruction.

## Classes

### logcheck

Installs and configure logcheck, a cronjob that sends you the (hopefully)
interesting bits of your logfiles.

#### Parameters

The following parameters are available in the `logcheck` class.

##### `ensure`

Data type: `Pattern['absent', 'present']`

Allows to uninstall logcheck.

Default value: 'present'

##### `mailto`

Data type: `String`

Who receives the mails (`SENDMAILTO`).

Default value: 'logcheck'

##### `report_level`

Data type: `Pattern['workstation', 'server', 'paranoid']`

Logcheck suppresses more or less messages depending on the intended usage
of this node (`REPORTLEVEL`).

Default value: 'server'

##### `summarize`

Data type: `Pattern['as-is', 'summary', 'unique']`

Send logs as-is, as a summary (one line of each type, in chronological
order), or as a strict unique list. `as-is` is the default, but `summary`
is the most readable (`SORTUNIQ`, `SYSLOGSUMMARY`).

Default value: 'as-is'

##### `display_intro`

Data type: `Boolean`

Include a boilerplate introduction with each mail (`INTRO`).

Default value: `true`

##### `display_fqdn`

Data type: `Boolean`

Display the fully qualified host name instead of just the host part
(`FQDN`).

Default value: `true`

##### `enable_cracking_ignore`

Data type: `Boolean`

Enable ignore patterns in the *cracking* layer.

Default value: `false`

##### `send_as_attachment`

Data type: `Boolean`

Sends the log excerpt as an attachement rather than in the mail body
(MAILASATTACH).

Default value: `false`

##### `extra_config`

Data type: `Hash`

Inserts further `NAME=value` pairs in the configuration file.

Default value: {}

##### `config_file`

Data type: `Stdlib::Absolutepath`

The configuration file to manage. Most users shouldn't have to touch this.

Default value: '/etc/logcheck/logcheck.conf'

##### `rulesets`

Data type: `Hash`

Hash data used to define rulesets from Hiera.

Default value: {}

### logcheck::config

Configure logcheck.conf from some user-friendly parameters and extra
configuration values. The args are documented in [`logcheck`](#logcheck).

This is part of the public API, but most users should prefer the `logcheck`
class.

#### Parameters

The following parameters are available in the `logcheck::config` class.

##### `mailto`

Data type: `String`



##### `report_level`

Data type: `Pattern['workstation', 'server', 'paranoid']`



##### `summarize`

Data type: `Pattern['as-is', 'summary', 'unique']`



##### `display_intro`

Data type: `Boolean`



##### `display_fqdn`

Data type: `Boolean`



##### `enable_cracking_ignore`

Data type: `Boolean`



##### `send_as_attachment`

Data type: `Boolean`



##### `extra_config`

Data type: `Hash`



Default value: {}

##### `config_file`

Data type: `Stdlib::Absolutepath`



Default value: '/etc/logcheck/logcheck.conf'

### logcheck::install

Manage the `logcheck` and `syslog-summary` packages.

This is part of the public API, but most users should prefer the `logcheck`
class.

The `syslog-summary` package may be installed to support `summary` summarize,
but is never uninstalled as it may break other parts of the system who might
rely on it.

#### Parameters

The following parameters are available in the `logcheck::install` class.

##### `ensure`

Data type: `Pattern['absent', 'present']`

Allows to uninstall logcheck.

##### `summarize`

Data type: `String`

Triggers management of `syslog-summary` when `summarize` requires it.

## Defined types

### logcheck::ruleset

Configure which log entries should be reported.

Logcheck sends three types of reports ("layers"), in separate mails:

1. Cracking attempts ("Security Alerts").
2. Policy violations ("Security Events").
3. System events.

The first two only include explicitely listed patterns, with further
filtering through the ignore patterns (i.e. a log line has both to match a
*report* pattern and not match any *ignore* pattern to be included in these
reports).

System events include everything, but the lines that match ignore patterns.
System events are further structured in three levels, with decreasing
verbosity (i.e. increasing amounts of ignore patterns):

1. Paranoid.
2. Server (the default).
3. Workstation.

A global configuration setting determines which level should be used for this
node. Each level automatically includes everything defined for the previous
ones (i.e. `server` is `paranoid` plus `server`-specific rules).

A ruleset is defined as a set of patterns for each of the seven possible
combinations of layers and levels, identified by the name of the system
component being reported on.

#### Parameters

The following parameters are available in the `logcheck::ruleset` defined type.

##### `title`

The system component this ruleset relates to. Be careful not to conflict
with files in the `logcheck-database` package, unless you actually intend
to replace them. I.e. most of the time you should use `smartd_custom` (or
some other suffix/prefix), not `smartd`.

##### `ensure`

Data type: `Pattern['absent', 'present']`



Default value: 'present'

##### `system_workstation_ignore`

Data type: `Array[String]`



Default value: []

##### `system_server_ignore`

Data type: `Array[String]`



Default value: []

##### `system_paranoid_ignore`

Data type: `Array[String]`



Default value: []

##### `violations_ignore`

Data type: `Array[String]`



Default value: []

##### `violations_report`

Data type: `Array[String]`



Default value: []

##### `cracking_ignore`

Data type: `Array[String]`



Default value: []

##### `cracking_report`

Data type: `Array[String]`



Default value: []

##### `basedir`

Data type: `Stdlib::Absolutepath`

You should not have to alter this.

Default value: '/etc/logcheck'

## Functions

